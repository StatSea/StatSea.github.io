---
layout: single
title: "[CD] Rì„ í™œìš©í•œ ì›¹ í¬ë¡¤ë§"
categories: [CD]
tags: [CD, Project, Crawling]
---

# Rì„ í™œìš©í•œ ì›¹ í¬ë¡¤ë§ ì‹¤ìŠµ ìš”ì•½

## 3.1 rvestë¥¼ í™œìš©í•œ ê¸°ë³¸ í¬ë¡¤ë§

### í•™ìŠµ ëª©í‘œ
- `rvest`ë¡œ ë„¤ì´ë²„ ë‰´ìŠ¤ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
- HTML êµ¬ì¡° ë¶„ì„ ë° ê¸°ì‚¬ ì œëª©/ë§í¬ í¬ë¡¤ë§
- ë°ì´í„° CSVë¡œ ì €ì¥í•˜ê¸°

### í•µì‹¬ ê°œë…
- **ì›¹ í¬ë¡¤ë§ vs ì›¹ ìŠ¤í¬ë˜í•‘**
- `robots.txt` í™•ì¸ â†’ í¬ë¡¤ë§ ì œí•œ ê°€ëŠ¥ì„± ìˆìŒ
- `read_html()`, `html_nodes()`, `html_text()`, `html_attr()` ë“± ì‚¬ìš©

### ì£¼ìš” ì½”ë“œ ì˜ˆì‹œ
```r
url <- "https://news.naver.com/main/ranking/popularDay.naver"
page <- read_html(url)

titles <- page %>% html_nodes(".rankingnews_box a") %>% html_text(trim = TRUE)
links <- page %>% html_nodes(".rankingnews_box a") %>% html_attr("href")
links <- ifelse(startsWith(links, "/"), paste0("https://news.naver.com", links), links)

news_data <- data.frame(ì œëª© = titles, ë§í¬ = links)
write.csv(news_data, "naver_news.csv", row.names = FALSE)
```

---

## 3.2 HTML í…Œì´ë¸” í¬ë¡¤ë§ ë° ì €ì¥

### í•™ìŠµ ëª©í‘œ
- HTML í…Œì´ë¸” ë°ì´í„° í¬ë¡¤ë§
- `html_table()`ë¡œ ë°ì´í„°í”„ë ˆì„ ë³€í™˜
- ë°ì´í„° ì •ë¦¬ ë° CSV ì €ì¥

### ì£¼ìš” ì½”ë“œ ì˜ˆì‹œ
```r
url <- "https://ko.wikipedia.org/wiki/ëŒ€í•œë¯¼êµ­ì˜_ì¸êµ¬_ë³€í™”"
tables <- read_html(url) %>% html_nodes("table") %>% html_table(fill = TRUE)

population_data <- tables[[2]]
colnames(population_data) <- c("ì—°ë„", "ì´ì¸êµ¬", "ë‚¨ì„±", "ì—¬ì„±", "ì¶œìƒë¥ ", "ì‚¬ë§ë¥ ")
population_data <- population_data[-1, ] %>% na.omit()

write.csv(population_data, "population_data.csv", row.names = FALSE)
```

---

## 3.3 API í™œìš© ë° JSON ì²˜ë¦¬

### í•™ìŠµ ëª©í‘œ
- `httr`ë¡œ API ìš”ì²­
- `jsonlite`ë¡œ JSON ì²˜ë¦¬
- ë°ì´í„°í”„ë ˆì„ ë³€í™˜ í›„ CSV ì €ì¥

### ì£¼ìš” ì½”ë“œ ì˜ˆì‹œ
```r
res <- GET("https://openapi.naver.com/v1/search/news.json?query=ë°ì´í„°+ë¶„ì„&display=5",
           add_headers("X-Naver-Client-Id" = "YOUR_CLIENT_ID",
                       "X-Naver-Client-Secret" = "YOUR_CLIENT_SECRET"))

json_data <- content(res, as = "text")
parsed_data <- fromJSON(json_data)

news_df <- parsed_data$items %>% select(title, link, description, pubDate)
write.csv(news_df, "naver_news_api.csv", row.names = FALSE)
```

---

## 3.4 í˜ì´ì§€ë„¤ì´ì…˜ & ë¡œê·¸ì¸ ì²˜ë¦¬

### í•™ìŠµ ëª©í‘œ
- í˜ì´ì§€ë„¤ì´ì…˜ ì²˜ë¦¬ (ì—¬ëŸ¬ í˜ì´ì§€ ë°˜ë³µ í¬ë¡¤ë§)
- `httr`ë¡œ ë¡œê·¸ì¸ í›„ ì„¸ì…˜ ìœ ì§€

### í˜ì´ì§€ë„¤ì´ì…˜ ì˜ˆì‹œ
```r
base_url <- "https://news.naver.com/main/ranking/popularDay.naver?page="
news_data <- data.frame()

for (page in 1:5) {
  url <- paste0(base_url, page)
  page_content <- read_html(url)
  titles <- page_content %>% html_nodes(".rankingnews_box a") %>% html_text(trim = TRUE)
  links <- page_content %>% html_nodes(".rankingnews_box a") %>% html_attr("href") %>%
           paste0("https://news.naver.com", .)
  news_data <- bind_rows(news_data, data.frame(ì œëª© = titles, ë§í¬ = links))
}
write.csv(news_data, "naver_news_pages.csv", row.names = FALSE)
```

---

## 3.5 ìë°”ìŠ¤í¬ë¦½íŠ¸ ê¸°ë°˜ í¬ë¡¤ë§ (RSelenium)

### í•™ìŠµ ëª©í‘œ
- ë™ì  í˜ì´ì§€ í¬ë¡¤ë§
- `RSelenium`ì„ í™œìš©í•œ JS ìš”ì†Œ ì œì–´ (í´ë¦­, ìŠ¤í¬ë¡¤ ë“±)

### ğŸ›  ê¸°ë³¸ ì˜ˆì‹œ
```r
library(RSelenium)
rD <- rsDriver(browser = "chrome", chromever = "latest", verbose = FALSE)
remDr <- rD$client
remDr$navigate("https://news.naver.com")
print(remDr$getTitle())
remDr$close()
rD$server$stop()
```

---

## 3.6 ì‹¤ì „ í”„ë¡œì íŠ¸ ë° ìë™í™”

### í•™ìŠµ ëª©í‘œ
- ë‰´ìŠ¤ íŠ¸ë Œë“œ ë¶„ì„ í”„ë¡œì íŠ¸ êµ¬ì„±
- `cronR`, `taskscheduleR`ì„ í™œìš©í•œ ìë™í™” ì‹¤í–‰

### ğŸ›  ì‹¤ì „ ì˜ˆì‹œ
```r
page <- read_html("https://news.naver.com/main/ranking/popularDay.naver")
titles <- page %>% html_nodes(".rankingnews_box a") %>% html_text(trim = TRUE)
links <- page %>% html_nodes(".rankingnews_box a") %>% html_attr("href") %>% paste0("https://news.naver.com", .)

news_data <- data.frame(ë‚ ì§œ = Sys.Date(), ì œëª© = titles, ë§í¬ = links)
if (file.exists("naver_news_trend.csv")) {
  old_data <- read.csv("naver_news_trend.csv")
  news_data <- bind_rows(old_data, news_data)
}
write.csv(news_data, "naver_news_trend.csv", row.names = FALSE)
```

### ìë™í™” ì˜ˆì‹œ (Linux)
```r
library(cronR)
cmd <- cron_rscript("/home/statcomp/naver_news_trend.R")
cron_add(cmd, frequency = "daily", at = "09:00", id = "naver_news")
```

### ìë™í™” ì˜ˆì‹œ (Windows)
```r
library(taskscheduleR)
taskscheduler_create(taskname = "naver_news_trend",
                     rscript = "C:/path/to/naver_news_trend.R",
                     schedule = "DAILY", starttime = "09:00")
```

---
