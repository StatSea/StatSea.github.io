---
layout: single
title: "[DL] 딥러닝 01wk2 "
categories: [DL]
tags: [DL]
---

딥러닝 01wk2 이해하기
---

## 기본 세팅
```python
import torch
import matplotlib.pyplot as plt

plt.rcParams['figure.figsize'] = (4.5, 3.0)
```
---

# 회귀 모형

## A. 아이스 아메리카노
- x 데이터, y 데이터가 존재한다면 산점도를 그려볼 수 있음

```python

plt.plot(x,y,'o')

```
---

## B. 가짜자료 만들기

- 방법 1. $y_i= w_0+w_1 x_i +\epsilon_i = 2.5 + 4x_i +\epsilon_i, \quad i=1,2,\dots,n$
  
```python
torch.manual_seed(43052)
x,_ = torch.randn(100).sort()
eps = torch.randn(100)*0.5
y = x * 4 + 2.5 + eps
```
- x = 온도 , y = 판매량 , eps = 오차
  
- 방법 2. ${\bf y}={\bf X}{\bf W} +\boldsymbol{\epsilon}$
- 행렬의 곱으로 나타내기
  
```python
X = torch.stack([torch.ones(100),x],axis=1)
W = torch.tensor([[2.5],[4.0]])
y = X@W + eps.reshape(100,1)
x = X[:,[1]]
```

- 여기서 구한 x와 y로 직선 그래프를 그릴 수 있음.
---

## C. 추세선 
- 추세선이란 주어진 x,y로 파라미터 w를 최대한 비슷하게 찾는 것이다.
- 추세선을 그리는 행위 =  (w0,w1) 을 선택하는일
---

## D. 손실 함수

### 예제1` -- $(\hat{w}_0,\hat{w}_1)=(-5,10)$을 선택하여 선을 그려보고 적당한지 판단해보자

```python
plt.plot(x,y,'o',label=r"observed data: $(x_i,y_i)$")
What = torch.tensor([[-5.0],[10.0]])
plt.plot(x,X@What,'--',label=r"estimated line: $(x_i,\hat{y}_i)$")
plt.legend()
```

- X의 shape = (100,2) , What의 shape = (2,1) 이므로 행렬 곱이 가능하다.
- x에 대한 예측값을 산점도로 그려보는 코드이다.
- 뭐가 더 적당한 추세선인지 판단하기 위해서는 loss의 개념을 도입해야 한다.

## E. Loss

$loss = \sum_{i=1}^{n}(y_i- \hat{y}_i)^2 = \sum_{i=1}^{n}\big(y_i - (\hat{w}_0+\hat{w}_1x_i)\big)^2$

$=({\bf y}-\hat{\bf y})^\top({\bf y}-\hat{\bf y})=({\bf y}-{\bf X}\hat{\bf W})^\top({\bf y}-{\bf X}\hat{\bf W})$










